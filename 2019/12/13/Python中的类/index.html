<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-loading-bar.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.1.0" rel="stylesheet" type="text/css">



  <link rel="icon" type="image/png" sizes="32x32" href="/images/my_favicon.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/my_favicon.png?v=6.1.0">










<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="title: Python中的类 tags:  类  categories:  Python  date: 2019-06-10 10:26:03定义类# -*- coding: utf-8 -*- import time  class Person(object):     &apos;&apos;&apos;所有的（中国）上海人民&apos;&apos;&apos;     birthplace = &apos;上海&apos;     interest = &apos;甜点&apos;">
<meta property="og:type" content="article">
<meta property="og:title" content="李大宝的包子">
<meta property="og:url" content="https://csniu.github.io/2019/12/13/Python中的类/index.html">
<meta property="og:site_name" content="李大宝的包子">
<meta property="og:description" content="title: Python中的类 tags:  类  categories:  Python  date: 2019-06-10 10:26:03定义类# -*- coding: utf-8 -*- import time  class Person(object):     &apos;&apos;&apos;所有的（中国）上海人民&apos;&apos;&apos;     birthplace = &apos;上海&apos;     interest = &apos;甜点&apos;">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2019-12-13T05:41:47.090Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="李大宝的包子">
<meta name="twitter:description" content="title: Python中的类 tags:  类  categories:  Python  date: 2019-06-10 10:26:03定义类# -*- coding: utf-8 -*- import time  class Person(object):     &apos;&apos;&apos;所有的（中国）上海人民&apos;&apos;&apos;     birthplace = &apos;上海&apos;     interest = &apos;甜点&apos;">






  <link rel="canonical" href="https://csniu.github.io/2019/12/13/Python中的类/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title> | 李大宝的包子</title>
  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-100475240-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-100475240-1');
</script>






  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <!--<a href="https://github.com/csniu" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>-->

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">李大宝的包子</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>
</li>

      
        
        
          
  
  <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签<span class="badge">16</span>
      </a>
</li>

      
        
        
          
  
  <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类<span class="badge">8</span>
      </a>
</li>

      
        
        
          
  
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档<span class="badge">12</span>
      </a>
</li>

      
        
        
          
  
  <li class="menu-item menu-item-commonweal">
    <a href="/404/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>公益 404</a>
</li>

      

      
    </ul>
  

  

  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  
    <div class="reading-progress-bar"></div>
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://csniu.github.io/2019/12/13/Python中的类/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="csniu">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/my_avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李大宝的包子">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline"></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-12-13T00:00:00+08:00">2019-12-13</time>
            

            
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/12/13/Python中的类/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/12/13/Python中的类/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <hr>
<p>title: Python中的类</p>
<p>tags:</p>
<ul>
<li>类</li>
</ul>
<p>categories:</p>
<ul>
<li>Python</li>
</ul>
<h2 id="date-2019-06-10-10-26-03"><a href="#date-2019-06-10-10-26-03" class="headerlink" title="date: 2019-06-10 10:26:03"></a>date: 2019-06-10 10:26:03</h2><h1 id="定义类"><a href="#定义类" class="headerlink" title="定义类"></a>定义类</h1><pre><code class="python"><span class="comment"># -*- coding: utf-8 -*-</span>
<span class="keyword">import</span> time

<span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span>
    <span class="string">'''所有的（中国）上海人民'''</span>
    birthplace = <span class="string">'上海'</span>
    interest = <span class="string">'甜点'</span>
    __country = <span class="string">'中国'</span>
    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, sex, birth)</span>:</span>
        self.name = name
        self.sex = sex
        self._birth = birth

    <span class="function"><span class="keyword">def</span> <span class="title">get_age</span><span class="params">(self)</span>:</span>
        tm_year = time.localtime().tm_year
        age = tm_year - self._birth
        <span class="keyword">return</span> age
</code></pre>
<blockquote>
<ol>
<li>在 python 定义类使用关键字 class。</li>
<li>类的命名一般遵守驼峰命名法。</li>
<li>类也一个对象。</li>
</ol>
</blockquote>
<a id="more"></a>
<p><strong>新式类与经典类</strong></p>
<p>新式类和经典类的最主要区别就是继承的问题，经典类是深度优先，新式类是广度优先。</p>
<p>当然如果利用的是 Python3.x 并且也不打算使用 Python2.x 的版本，也可以忽略这个问题。</p>
<p>在 <strong>Python2.x</strong> 中默认都是经典类，只有显示继承 object 才是新式类。如下：</p>
<blockquote>
<p>class ClassName(object): pass   新式类</p>
<p>class ClassName(): pass  经典类</p>
<p>class ClassName: pass  经典类</p>
</blockquote>
<p>在 <strong>Python3.x </strong>中取消了经典类，默认都是新式类，也不必显示继承 object。如下：</p>
<blockquote>
<p>class ClassName(object): pass</p>
<p>class ClassName(): pass </p>
<p>class ClassName: pass</p>
<p>以上三种写法都是新式类，但是推荐第一张写法。</p>
</blockquote>
<h2 id="代码分解"><a href="#代码分解" class="headerlink" title="代码分解"></a>代码分解</h2><pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span>
</code></pre>
<blockquote>
<p>通过关键字定义 Person 类，并且继承 object</p>
</blockquote>
<pre><code class="python"><span class="string">'''所有的（中国）上海人民'''</span>
</code></pre>
<blockquote>
<p>类的文档字符串，可通过 Person.__doc__ 访问或者 p.__doc__ (p 为 Person的一个实例)。</p>
</blockquote>
<pre><code class="python">birthplace = <span class="string">'上海'</span>
interest = <span class="string">'甜点'</span>
__country = <span class="string">'中国'</span>
</code></pre>
<blockquote>
<p>类属性，是所有实例对象所共有的。</p>
</blockquote>
<pre><code class="python"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, sex, birth)</span>:</span>
    self.name = name
    self.sex = sex
    self._birth = birth
</code></pre>
<blockquote>
<p>类的构造器函数</p>
</blockquote>
<pre><code class="python">self.name = name
self.sex = sex
self._birth = birth
</code></pre>
<blockquote>
<p>实例属性，每个实例所特有的属性，在实例化时需要提供的。</p>
</blockquote>
<pre><code class="python"><span class="function"><span class="keyword">def</span> <span class="title">get_age</span><span class="params">(self)</span>:</span>
    tm_year = time.localtime().tm_year
    age = tm_year - self._birth
    <span class="keyword">return</span> age
</code></pre>
<blockquote>
<p>类方法。第一的参数必须是 self 表示实例自身，其他和普通函数相同。</p>
</blockquote>
<h2 id="公有属性、私有属性、保护属性、特殊属性、类属性、实例属性"><a href="#公有属性、私有属性、保护属性、特殊属性、类属性、实例属性" class="headerlink" title="公有属性、私有属性、保护属性、特殊属性、类属性、实例属性"></a>公有属性、私有属性、保护属性、特殊属性、类属性、实例属性</h2><p><strong>1. 公有属性</strong>就是在类外可以方法的属性，如上例的 birthplace、interest、name、sex 属性，如下通过点访问：</p>
<pre><code class="python">p = Person(name=<span class="string">'张三'</span>, sex=<span class="string">'男'</span>, birth=<span class="number">1990</span>)
print(p.birthplace)
print(p.interest)
print(p.name)
print(p.sex)
</code></pre>
<p><strong>2. 私有属性</strong>就是在类的外不不能访问或不想被外部访问的属性，以双下划线开头的属性，如上例中的 __country，如下</p>
<pre><code class="python">print(p.__country)
</code></pre>
<p><code>p.__country</code> 会抛出 AttributeError 错误。</p>
<p>严格来说 python 没有完全限制你访问属性，<code>__country</code> 只是被转换成 <code>_Person__country</code> ,通过 <code>p._Person__country</code> 以然可以访问私有属性。</p>
<p><strong>3. 保护属性</strong>是以单下划线开头的属性，如上例中的 _birth。如下：</p>
<pre><code class="python">print(p._birth)
</code></pre>
<p>保护属性当然不是真的受保护属性，不让你从外部访问。只是一种约定，以单下划线开头的属性只是类内部私有的，不提供给外部使用。当然了，如果你一定要用也没有办法阻止你。</p>
<p><strong>4. 特殊属性</strong>就是 python 内置的一些类属性，具有特殊意义的属性。以双下划线开头和结尾的属性。如上例的 __doc__ 。如下：</p>
<pre><code class="python">print(p.__doc__)
print(Person.__doc__)
</code></pre>
<p><code>__doc__</code> 表示类的文档字符串。通过类属性或实例属性都可以访问。</p>
<p>类似的还有如：<code>__dict__</code> : 类的所有属性组成的字典，<code>__module__</code>：类定义所在的模块等。</p>
<p><strong>5. 类属性</strong>是类对象的属性 ，也是所有实例对象的共有属性。不是定义在构造器类的属性。如上例的 birthplace、interest、__country。类属性也是可以通过继承获得和覆盖的。</p>
<p>类属性是类实例化后，实例默认就带有的属性。可以通过类对象访问，也可以通过实例对象访问，如下：</p>
<pre><code class="python">print(Person.birthplace)
print(p.birthplace)
</code></pre>
<p>重新赋值</p>
<blockquote>
<ol>
<li>通过类对象重新赋值，所有实例对象的属性也会改变。如下：</li>
</ol>
<pre><code class="python">p = Person(name=<span class="string">'张三'</span>, sex=<span class="string">'男'</span>, birth=<span class="number">1990</span>)
print(p.birthplace)  <span class="comment"># 上海</span>
Person.birthplace = <span class="string">'北京'</span>
print(p.birthplace)  <span class="comment"># 北京</span>
</code></pre>
<ol start="2">
<li>通过实例对象重新赋值，python 会该实例创建一个同名的实例属性，并且实例属性会强制匹配掉类属性。如下：</li>
</ol>
<pre><code class="python">p = Person(name=<span class="string">'张三'</span>, sex=<span class="string">'男'</span>, birth=<span class="number">1990</span>)
print(p.birthplace)  <span class="comment"># 类属性，上海</span>
p.birthplace = <span class="string">'北京'</span>
print(p.birthplace)  <span class="comment"># 实例属性， 北京</span>
<span class="keyword">del</span> p.birthplace  <span class="comment"># 删除实例属性</span>
print(p.birthplace)  <span class="comment"># 类属性， 上海</span>
</code></pre>
</blockquote>
<p><strong>6. 实例属性</strong>就是定义在构造器内的属性。在实例化时需要提供的属性（也可以有默认值），如上例中的 name、sex、_birth。</p>
<blockquote>
<p><code>hasattr(obj, attr)</code>：判断对象是否具有指定属性/方法；</p>
<p><code>getattr(obj, attr[, default])</code> 获取属性/方法的值, 要是没有对应的属性则返回 default 值（前提是设置了 default），否则会抛出 AttributeError 异常；</p>
<p><code>setattr(obj, attr, value)</code>：设定该属性/方法的值，类似于 obj.attr=value；</p>
</blockquote>
<h2 id="类方法、实例方法、静态方法、特殊方法"><a href="#类方法、实例方法、静态方法、特殊方法" class="headerlink" title="类方法、实例方法、静态方法、特殊方法"></a>类方法、实例方法、静态方法、特殊方法</h2><pre><code class="python"><span class="comment"># -*- coding: utf-8 -*-</span>
<span class="keyword">import</span> time

<span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span>
    <span class="string">'''所有的（中国）上海人民'''</span>
    birthplace = <span class="string">'上海'</span>
    interest = <span class="string">'甜点'</span>
    __country = <span class="string">'中国'</span>
    instance_number = <span class="number">0</span>
    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, sex, birth)</span>:</span>
        self.name = name
        self.sex = sex
        self._birth = birth
        Person.instance_number = Person.instance_number + <span class="number">1</span>

    <span class="function"><span class="keyword">def</span> <span class="title">get_age</span><span class="params">(self, *args, **kwargs)</span>:</span>
        tm_year = time.localtime().tm_year
        age = tm_year - self._birth
        <span class="keyword">return</span> age

<span class="meta">    @staticmethod</span>
    <span class="function"><span class="keyword">def</span> <span class="title">get_time</span><span class="params">(*args, **kwargs)</span>:</span>  
        print(<span class="string">'Class Attribute: '</span>, Person.birthplace)
        print(time.time())
        print(<span class="string">'Args: '</span>, args)
        print(<span class="string">'Kwargs: '</span>, kwargs)

<span class="meta">    @classmethod</span>
    <span class="function"><span class="keyword">def</span> <span class="title">get_instance_number</span><span class="params">(cls, *args, **kwargs)</span>:</span>
        print(<span class="string">'Class: '</span>, cls)
        print(<span class="string">'Args: '</span>, args)
        print(<span class="string">'Kwargs: '</span>, kwargs)
        print(<span class="string">'Instance Number: '</span>, cls.instance_number)  

p = Person(name=<span class="string">'张三'</span>, sex=<span class="string">'男'</span>, birth=<span class="number">1990</span>)   
</code></pre>
<ol>
<li>实例方法： 第一个参数为 self 的方法，除了类方法和静态方法都是实例方法。self 表示实例本身。如上例中get_age 方法。只能通过实例对象调用。如下：</li>
</ol>
<pre><code class="python">p = Person(name=<span class="string">'张三'</span>, sex=<span class="string">'男'</span>, birth=<span class="number">1990</span>)
print(p.get_age())
print(Person.get_age())  <span class="comment"># 会报错</span>
</code></pre>
<ol start="2">
<li>类方法： 使用 @classmethod 装饰器装饰，并且第一个参数为类对象。如上例中的 get_instance_number 方法。在类方法中无法访问实例的属性和方法。可以通过类对象或实例对象调用，如下：</li>
</ol>
<pre><code class="python">print(Person.get_instance_number())
print(p.get_instance_number())
</code></pre>
<ol start="3">
<li>静态方法：使用 @staticmethod 装饰器装饰，并且没有隐含参数。如上例中的 get_time 方法。在静态方法中因为没有隐含参数（类或实例对象），所有在静态方法中无法访问实例的属性和方法，如过要访问类方法或属性要通过类对象引用，如上例。可以通过类对象或实例对象调用，如下：</li>
</ol>
<pre><code class="python">print(Person.get_time())
print(p.get_time())
</code></pre>
<ol start="4">
<li>特殊方法：就是 python 内置的一些方法，也属于以上三种之一。以双下划线开头和结尾的方法。有很多的魔法方法后面再聊。如上例的 <code>__init__</code>方法。</li>
</ol>
<h2 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h2><p>继承就是在不需要重新编写的情况下，能够使用现有类的方法的方法。被继承的类被称为父类或基类，需要继承的类称为子类或派生类。</p>
<p>继承的功能：</p>
<blockquote>
<ol>
<li>获得父类的方法或属性。</li>
<li>修改或覆盖父类的方法或属性。</li>
<li>增加新的方法或属性。</li>
</ol>
</blockquote>
<p><strong>1.获得父类的方法或属性</strong></p>
<pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">Person</span><span class="params">(object)</span>:</span>
    legs = <span class="number">2</span>
    __star = <span class="string">'地球'</span>

    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span>
        self.name = name

    <span class="function"><span class="keyword">def</span> <span class="title">talk</span><span class="params">(self)</span>:</span>
        <span class="keyword">return</span> <span class="string">'blabla'</span>

<span class="class"><span class="keyword">class</span> <span class="title">Chinese</span><span class="params">(Person)</span>:</span>
    <span class="keyword">pass</span>

p = Chinese(<span class="string">'zhangsh'</span>)
print(p.legs)  
print(p._Person__star)  <span class="comment"># 注意私有属性的转换名</span>
print(p.talk())
print(p.name)
</code></pre>
<p># 这样在子类中不需要进行任何的操作就可以获得父类的所有方法。</p>
<p><strong>2. 修改父类的方法或属性</strong></p>
<pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">Alien</span><span class="params">(Person)</span>:</span>
    __star = <span class="string">'火星'</span>

    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, sex)</span>:</span>
        super(Alien, self).__init__(name)
        print(self.name)
        self.sex = sex
        <span class="keyword">if</span> self.sex == <span class="string">'男'</span>:
            self.name = <span class="string">'大卫'</span>

    <span class="function"><span class="keyword">def</span> <span class="title">talk</span><span class="params">(self)</span>:</span>
        content = super(Alien,self).talk()
        print(content)
        <span class="keyword">return</span> <span class="string">'You need a Python!'</span>

et = Alien(<span class="string">'张三'</span>, <span class="string">'男'</span>)
print(et.name)
print(et.talk())
</code></pre>
<blockquote>
<p>super(Alien, self)：返回 Alien 的父类对象。如果不使用 super 方法，则会完全覆盖父类的对应功能。</p>
<p>类属性直接覆盖就可以。</p>
<p>实例属性，需要先继承再重构</p>
<p>修改方法是也是先先继承再重构</p>
</blockquote>
<p><strong>3.添加新的属性或功能</strong></p>
<p>直接在子类中进行定义就可以。注意父类中如果存在<code>__init__</code>方法，如上。</p>
<h3 id="多重继承"><a href="#多重继承" class="headerlink" title="多重继承"></a>多重继承</h3><p>继承既然有这么多的好处，那如果需要的功能在多个类中，要怎么办昵？</p>
<p>这个时候就需要用到多重继承了。使用方法都和单继承一样，需要注意的是子类调用父类方法时的查找顺序问题。</p>
<p>MRO（Method Resolution Order），方法解析顺序。代表的类继承的顺序。可通过类方法<strong><code>mro()</code></strong>查看。</p>
<p>在新式类中是广度优先，经典类中是深度优先。</p>
<h4 id="super-原理"><a href="#super-原理" class="headerlink" title="super 原理"></a>super 原理</h4><pre><code class="python"><span class="function"><span class="keyword">def</span> <span class="title">super</span><span class="params">(cls, inst)</span>:</span>
    mro = inst.__class__.mro()
    <span class="keyword">return</span> mro[mro.index(cls) + <span class="number">1</span>]
</code></pre>
<blockquote>
<ol>
<li>首先获取实例类的 MRO 顺序列表。</li>
<li>查找 cls 类的序号。</li>
<li>返回序号加一的类，上一个父类。</li>
</ol>
</blockquote>
<p>所有说调用super方法并不是简单的返回父类，而是通过一定的算法（C3）实现广度优先的调用。</p>
<p>更加详细的介绍可以自行 Google 菱形继承或super()，示例如下：</p>
<pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">()</span>:</span>
    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span>
        print(<span class="string">"进入A…"</span>)
        print(<span class="string">"离开A…"</span>)

<span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span>
    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span>
        print(<span class="string">"进入B…"</span>)
        super().__init__()
        print(<span class="string">"离开B…"</span>)

<span class="class"><span class="keyword">class</span> <span class="title">C</span><span class="params">(A)</span>:</span> 
    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span>
        print(<span class="string">"进入C…"</span>)
        super().__init__()
        print(<span class="string">"离开C…"</span>)

<span class="class"><span class="keyword">class</span> <span class="title">D</span><span class="params">(B, C)</span>:</span>
    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span>
        print(<span class="string">"进入D…"</span>)
        super().__init__()
        print(<span class="string">"离开D…"</span>)

d = D()
<span class="comment"># 进入D…</span>
<span class="comment"># 进入B…</span>
<span class="comment"># 进入C…</span>
<span class="comment"># 进入A…</span>
<span class="comment"># 离开A…</span>
<span class="comment"># 离开C…</span>
<span class="comment"># 离开B…</span>
<span class="comment"># 离开D…</span>
</code></pre>
<h1 id="类的魔法方法"><a href="#类的魔法方法" class="headerlink" title="类的魔法方法"></a>类的魔法方法</h1><p>魔法方法就是能够给类添加一些“魔法”的特殊方法，通过以双下划线开头和结尾。最常用的应该就是 <code>__init__</code>方法了。</p>
<h2 id="类的实例化"><a href="#类的实例化" class="headerlink" title="类的实例化"></a>类的实例化</h2><p>一般认为python 类的实例化操作首先是调用 <code>__init__</code> 方法，但是其实不是。首先调用的是 <code>__new__</code>方法，然后再调用 <code>__init__</code>方法。（在调用 <code>__new__</code>之前还有吗？）</p>
<p><code>__new__</code>: 构造器，类实例化之前调用的方法，将类作为第一个参数传入，并且返回类的实例。</p>
<p><code>__init__</code>: 初始化操作，根据<code>__new__</code>方法返回的实例（第一个参数 self）进行一些初始化操作，但是不返回任何对象（None）。</p>
<blockquote>
<p>python 类实例化的顺序：</p>
<ol>
<li>调用<code>__new__</code>方法，根据参数进行一些操作，并返回类实例。</li>
<li>调用<code>__init__</code>方法，将 <code>__new__</code> 方法方法的实例作为第一个参数传入，其他参数原封不动的传入（即使在 <code>__new__</code> 方法有改变，也不会影响传入值。）</li>
</ol>
</blockquote>
<pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">number</span><span class="params">(float)</span>:</span>
    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kwargs)</span>:</span>
        print(<span class="string">'进入 new 方法！'</span>)
        print(<span class="string">'args: '</span>, args, kwargs)
        args = [<span class="string">'3.65'</span>]
        <span class="keyword">return</span> float.__new__(cls, *args, **kwargs)

    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, *args, **kwargs)</span>:</span>
        print(<span class="string">'进入 init 方法！'</span>)
        print(<span class="string">'##'</span>,type(self))
        print(args, kwargs)
        self.arg = args
        self.kw = kwargs

f = number(<span class="string">'3.4'</span>)
print(f)
print(f.arg)
print(f.kw)
</code></pre>
<p>如下是一个只能实例化一次类（实例化多次也是返回一个实例）：</p>
<pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span><span class="params">(object)</span>:</span>
    <span class="string">"""单例"""</span>
    _instance = <span class="literal">None</span>
    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kwargs)</span>:</span>
        <span class="keyword">if</span> <span class="keyword">not</span> cls._instance:
            cls._instance = super(Singleton, cls).__new__(cls, *args, **kwargs)
        <span class="keyword">return</span> cls._instance
<span class="class"><span class="keyword">class</span> <span class="title">MySingleton</span><span class="params">(Singleton)</span>:</span>
    <span class="keyword">pass</span>
a = MySingleton()
b = MySingleton()
print(a <span class="keyword">is</span> b)    <span class="comment"># True</span>
</code></pre>
<h2 id="其他魔法方法"><a href="#其他魔法方法" class="headerlink" title="其他魔法方法"></a>其他魔法方法</h2><p>python 中还有很多类似的魔法方法。</p>
<p>有操作符类，可以进行操作符重载，从而实现一些运算方法。</p>
<p>有类的表示方面的，可以实现不同的方法调用展现出不同的形式。</p>
<p>还有对属性控制方面的，可以控制在访问属性、删除属性、设置属性以及属性不存在的情况下的行为。</p>
<p>以及上下文管理的魔法方法。等等，如下表，详情请看参考连接或官方文档。</p>
<table>
<thead>
<tr>
<th><strong>魔法方法</strong></th>
<th><strong>含义</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td><strong>基本的魔法方法</strong></td>
</tr>
<tr>
<td><code>__new__(cls[, ...])</code></td>
<td>1. <strong>new</strong> 是在一个对象实例化的时候所调用的第一个方法2. 它的第一个参数是这个类，其他的参数是用来直接传递给 <strong>init</strong> 方法3. <strong>new</strong> 决定是否要使用该 <strong>init</strong> 方法，因为 <strong>new</strong> 可以调用其他类的构造方法或者直接返回别的实例对象来作为本类的实例，如果 <strong>new</strong> 没有返回实例对象，则 <strong>init</strong> 不会被调用4. <strong>new</strong> 主要是用于继承一个不可变的类型比如一个 tuple 或者 string</td>
</tr>
<tr>
<td><code>__init__(self[, ...])</code></td>
<td>构造器，当一个实例被创建的时候调用的初始化方法</td>
</tr>
<tr>
<td><code>__del__(self)</code></td>
<td>析构器，当一个实例被销毁的时候调用的方法</td>
</tr>
<tr>
<td><code>__call__(self[, args...])</code></td>
<td>允许一个类的实例像函数一样被调用：x(a, b) 调用 x.<strong>call</strong>(a, b)</td>
</tr>
<tr>
<td><code>__len__(self)</code></td>
<td>定义当被 len() 调用时的行为</td>
</tr>
<tr>
<td><code>__repr__(self)</code></td>
<td>定义当被 repr() 调用时的行为</td>
</tr>
<tr>
<td><code>__str__(self)</code></td>
<td>定义当被 str() 调用时的行为</td>
</tr>
<tr>
<td><code>__bytes__(self)</code></td>
<td>定义当被 bytes() 调用时的行为</td>
</tr>
<tr>
<td><code>__hash__(self)</code></td>
<td>定义当被 hash() 调用时的行为</td>
</tr>
<tr>
<td><code>__bool__(self)</code></td>
<td>定义当被 bool() 调用时的行为，应该返回 True 或 False</td>
</tr>
<tr>
<td><code>__format__(self, format_spec)</code></td>
<td>定义当被 format() 调用时的行为</td>
</tr>
<tr>
<td></td>
<td><strong>有关属性</strong></td>
</tr>
<tr>
<td><strong><code>__getattr__(self, name)</code></strong></td>
<td>定义当用户试图获取一个不存在的属性时的行为， <strong># 防止死循环  （1）</strong></td>
</tr>
<tr>
<td><strong><code>__getattribute__(self, name)</code></strong></td>
<td>定义当该类的属性被访问时的行为，<strong>不论属性存不存在， 先**</strong><strong>getattribute</strong> 后<strong>getattr</strong>**</td>
</tr>
<tr>
<td><code>__setattr__(self, name, value)</code></td>
<td>定义当一个属性被设置时的行为</td>
</tr>
<tr>
<td><code>__delattr__(self, name)</code></td>
<td>定义当一个属性被删除时的行为</td>
</tr>
<tr>
<td><code>__dir__(self)</code></td>
<td>定义当 dir() 被调用时的行为</td>
</tr>
<tr>
<td><code>__get__(self, instance, owner)</code></td>
<td>定义当<strong>描**</strong>述符**的值被取得时的行为</td>
</tr>
<tr>
<td><code>__set__(self, instance, value)</code></td>
<td>定义当<strong>描述符</strong>的值被改变时的行为</td>
</tr>
<tr>
<td><code>__delete__(self, instance)</code></td>
<td>定义当<strong>描述符</strong>的值被删除时的行为</td>
</tr>
<tr>
<td></td>
<td><strong>比较操作符</strong></td>
</tr>
<tr>
<td><code>__lt__(self, other)</code></td>
<td>定义小于号的行为：x &lt; y 调用 x.<strong>lt</strong>(y)</td>
</tr>
<tr>
<td><code>__le__(self, other)</code></td>
<td>定义小于等于号的行为：x &lt;= y 调用 x.<strong>le</strong>(y)</td>
</tr>
<tr>
<td><code>__eq__(self, other)</code></td>
<td>定义等于号的行为：x == y 调用 x.<strong>eq</strong>(y)</td>
</tr>
<tr>
<td><code>__ne__(self, other)</code></td>
<td>定义不等号的行为：x != y 调用 x.<strong>ne</strong>(y)</td>
</tr>
<tr>
<td><code>__gt__(self, other)</code></td>
<td>定义大于号的行为：x &gt; y 调用 x.<strong>gt</strong>(y)</td>
</tr>
<tr>
<td><code>__ge__(self, other)</code></td>
<td>定义大于等于号的行为：x &gt;= y 调用 x.<strong>ge</strong>(y)</td>
</tr>
<tr>
<td></td>
<td><strong>算数运算符</strong></td>
</tr>
<tr>
<td><code>__add__(self, other)</code></td>
<td>定义加法的行为：+</td>
</tr>
<tr>
<td><code>__sub__(self, other)</code></td>
<td>定义减法的行为：-</td>
</tr>
<tr>
<td><code>__mul__(self, other)</code></td>
<td>定义乘法的行为：*</td>
</tr>
<tr>
<td><code>__truediv__(self, other)</code></td>
<td>定义真除法的行为：/</td>
</tr>
<tr>
<td><code>__floordiv__(self, other)</code></td>
<td>定义整数除法的行为：//</td>
</tr>
<tr>
<td><code>__mod__(self, other)</code></td>
<td>定义取模算法的行为：%</td>
</tr>
<tr>
<td><code>__divmod__(self, other)</code></td>
<td>定义当被 divmod() 调用时的行为</td>
</tr>
<tr>
<td><code>__pow__(self, other[, modulo])</code></td>
<td>定义当被 power() 调用或 ** 运算时的行为</td>
</tr>
<tr>
<td><code>__lshift__(self, other)</code></td>
<td>定义按位左移位的行为：&lt;&lt;</td>
</tr>
<tr>
<td><code>__rshift__(self, other)</code></td>
<td>定义按位右移位的行为：&gt;&gt;</td>
</tr>
<tr>
<td><code>__and__(self, other)</code></td>
<td>定义按位与操作的行为：&amp;</td>
</tr>
<tr>
<td><code>__xor__(self, other)</code></td>
<td>定义按位异或操作的行为：^</td>
</tr>
<tr>
<td><code>__or__(self, other)</code></td>
<td>定义按位或操作的行为：\</td>
<td></td>
</tr>
<tr>
<td></td>
<td><strong>反运算</strong>   （a+b , python 会先找a 的 add 方法， 如果a 没有， 则会在b 中找 radd 方法（反运算方法））</td>
</tr>
<tr>
<td><code>__radd__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rsub__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rmul__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rtruediv__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rfloordiv__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rmod__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rdivmod__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rpow__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rlshift__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rrshift__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rand__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__rxor__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td><code>__ror__(self, other)</code></td>
<td>（与上方相同，当左操作数不支持相应的操作时被调用）</td>
</tr>
<tr>
<td></td>
<td><strong>增量赋值运算</strong></td>
</tr>
<tr>
<td><code>__iadd__(self, other)</code></td>
<td>定义赋值加法的行为：+=</td>
</tr>
<tr>
<td><code>__isub__(self, other)</code></td>
<td>定义赋值减法的行为：-=</td>
</tr>
<tr>
<td><code>__imul__(self, other)</code></td>
<td>定义赋值乘法的行为：*=</td>
</tr>
<tr>
<td><code>__itruediv__(self, other)</code></td>
<td>定义赋值真除法的行为：/=</td>
</tr>
<tr>
<td><code>__ifloordiv__(self, other)</code></td>
<td>定义赋值整数除法的行为：//=</td>
</tr>
<tr>
<td><code>__imod__(self, other)</code></td>
<td>定义赋值取模算法的行为：%=</td>
</tr>
<tr>
<td><code>__ipow__(self, other[, modulo])</code></td>
<td>定义赋值幂运算的行为：**=</td>
</tr>
<tr>
<td><code>__ilshift__(self, other)</code></td>
<td>定义赋值按位左移位的行为：&lt;&lt;=</td>
</tr>
<tr>
<td><code>__irshift__(self, other)</code></td>
<td>定义赋值按位右移位的行为：&gt;&gt;=</td>
</tr>
<tr>
<td><code>__iand__(self, other)</code></td>
<td>定义赋值按位与操作的行为：&amp;=</td>
</tr>
<tr>
<td><code>__ixor__(self, other)</code></td>
<td>定义赋值按位异或操作的行为：^=</td>
</tr>
<tr>
<td><code>__ior__(self, other)</code></td>
<td>定义赋值按位或操作的行为：\</td>
<td>=</td>
</tr>
<tr>
<td></td>
<td><strong>一元操作符</strong></td>
</tr>
<tr>
<td><code>__pos__(self)</code></td>
<td>定义正号的行为：+x</td>
</tr>
<tr>
<td><code>__neg__(self)</code></td>
<td>定义负号的行为：-x</td>
</tr>
<tr>
<td><code>__abs__(self)</code></td>
<td>定义当被 abs() 调用时的行为</td>
</tr>
<tr>
<td><code>__invert__(self)</code></td>
<td>定义按位求反的行为：~x</td>
</tr>
<tr>
<td></td>
<td><strong>类型转换</strong></td>
</tr>
<tr>
<td><code>__complex__(self)</code></td>
<td>定义当被 complex() 调用时的行为（需要返回恰当的值）</td>
</tr>
<tr>
<td><code>__int__(self)</code></td>
<td>定义当被 int() 调用时的行为（需要返回恰当的值）</td>
</tr>
<tr>
<td><code>__float__(self)</code></td>
<td>定义当被 float() 调用时的行为（需要返回恰当的值）</td>
</tr>
<tr>
<td><code>__round__(self[, n])</code></td>
<td>定义当被 round() 调用时的行为（需要返回恰当的值）</td>
</tr>
<tr>
<td><code>__index__(self)</code></td>
<td>1. 当对象是被应用在切片表达式中时，实现整形强制转换2. 如果你定义了一个可能在切片时用到的定制的数值型,你应该定义 <strong>index</strong>3. 如果 <strong>index</strong> 被定义，则 <strong>int</strong> 也需要被定义，且返回相同的值</td>
</tr>
<tr>
<td></td>
<td><strong>上下文管理（with 语句）</strong></td>
</tr>
<tr>
<td><code>__enter__(self)</code></td>
<td>1. 定义当使用 with 语句时的初始化行为2. <strong>enter</strong> 的返回值被 with 语句的目标或者 as 后的名字绑定</td>
</tr>
<tr>
<td><code>__exit__(self, exc_type, exc_value, traceback)</code></td>
<td>1. 定义当一个代码块被执行或者终止后上下文管理器应该做什么2. 一般被用来处理异常，清除工作或者做一些代码块执行完毕之后的日常工作</td>
</tr>
<tr>
<td></td>
<td><strong>容器类型</strong></td>
</tr>
<tr>
<td><code>__len__(self)</code></td>
<td>定义当被 len() 调用时的行为（返回容器中元素的个数）</td>
</tr>
<tr>
<td><code>__getitem__(self, key)</code></td>
<td>定义获取容器中指定元素的行为，相当于 self[key]</td>
</tr>
<tr>
<td><code>__setitem__(self, key, value)</code></td>
<td>定义设置容器中指定元素的行为，相当于 self[key] = value</td>
</tr>
<tr>
<td><code>__delitem__(self, key)</code></td>
<td>定义删除容器中指定元素的行为，相当于 del self[key]</td>
</tr>
<tr>
<td><code>__iter__(self)</code></td>
<td>定义当迭代容器中的元素的行为</td>
</tr>
<tr>
<td><code>__reversed__(self)</code></td>
<td>定义当被 reversed() 调用时的行为</td>
</tr>
<tr>
<td><code>__contains__(self, item)</code></td>
<td>定义当使用成员测试运算符（in 或 not in）时的行为</td>
</tr>
</tbody>
</table>
<h1 id="元类"><a href="#元类" class="headerlink" title="元类"></a>元类</h1><p><strong><em>写在前面，元类是一种非常高级的“魔法”，一般情况下是用不到的。当然最好也别轻易的尝试，除非你真的明白了其中的原理。当然也只是介绍了一些基础知识和自己的理解。</em></strong></p>
<p>在大多数编程语言中，类就是一组用来描述如何生成一个对象的代码段。但是，Python中的类还远不止如此。</p>
<p><strong>类同样也是一种对象。</strong>这个对象（类）自身拥有创建对象（类实例）的能力，而这就是为什么它是一个类的原因。但它的本质仍对象，是对象就可以对它进行一些操作，如赋值、拷贝、当作参数传递等。</p>
<p>既然类也是对象，那类是通过什么创建的昵？</p>
<p><strong>元类就是用来创建类的类。</strong>如Python 内置的 type 函数，本质上就是一个元类，是python默认用来创建所有类的元类。</p>
<blockquote>
<p>type(object_or_name, bases, dict)</p>
<p>object_or_name:  类 或者是一个表示类名的字符串，</p>
<p>bases: 元组类，表示类的基类。</p>
<p>dict: 字典类型，用来存放该类的所有属性和方法。</p>
<pre><code class="python">classname = type(<span class="string">'classname'</span>, (), {<span class="string">'name'</span>: <span class="string">'张三'</span>})  <span class="comment"># 创建一个类</span>
print(classname)
print(classname.name)
</code></pre>
</blockquote>
<h2 id="类的创建过程"><a href="#类的创建过程" class="headerlink" title="类的创建过程"></a>类的创建过程</h2><ol>
<li>当python解释器看到 class 时，会首先解析 <code>class ...</code>中的内容。解析基类的信息，主要是找到 <code>__metaclass__</code>属性。查找的顺序如下：</li>
</ol>
<blockquote>
<pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(Bar)</span>:</span>
   <span class="keyword">pass</span>
</code></pre>
<ol>
<li>首先会在 Foo 类中查收是否有定义 <code>__metaclass__</code>属性，如果没有则到其父类中查找。</li>
<li>重复上述步骤。</li>
<li>如果所有父类中都没定义 <code>__metaclass__</code>属性，则会到模块层中查找，并尝试同样的操作。</li>
<li>如果还是没有找到，则会使用内置的 type 元类。</li>
</ol>
</blockquote>
<ol start="2">
<li>找到元类后，python 需要准备 namespace，如果元类中定义了 <code>__prepare__</code> ，则会通过调用它来得到 namespace。</li>
<li>之后是调用 <code>exec</code> 来执行类的 body，包括属性和方法的定义，最后这些定义会被保存进 namespace。</li>
<li>上述步骤结束后，就得到了创建类需要的所有信息，这时 Python 会调用元类的构造函数来真正创建类。</li>
</ol>
<h2 id="自定义元类"><a href="#自定义元类" class="headerlink" title="自定义元类"></a>自定义元类</h2><p>元类最主要的作用就是为了在创建类时能够自动的改变类。</p>
<pre><code class="python"><span class="comment"># 元类会自动将你通常传给‘type’的参数作为自己的参数传入</span>
<span class="function"><span class="keyword">def</span> <span class="title">upper_attr</span><span class="params">(future_class_name, future_class_parents, future_class_attr)</span>:</span>
    <span class="string">'''返回一个类对象，将属性都转为大写形式'''</span>
    <span class="comment">#  选择所有不以'__'开头的属性</span>
    attrs = ((name, value) <span class="keyword">for</span> name, value <span class="keyword">in</span> future_class_attr.items() 
        <span class="keyword">if</span> <span class="keyword">not</span> name.startswith(<span class="string">'__'</span>))
     <span class="comment"># 将它们转为大写形式</span>
    uppercase_attr = dict((name.upper(), value) <span class="keyword">for</span> name, value <span class="keyword">in</span> attrs)
    <span class="comment"># 通过'type'来做类对象的创建</span>
    <span class="keyword">return</span> type(future_class_name, future_class_parents, uppercase_attr)

__metaclass__ = upper_attr  <span class="comment">#  这会作用到这个模块中的所有类</span>

<span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(object)</span>:</span>
    <span class="comment"># 我们也可以只在这里定义__metaclass__，这样就只会作用于这个类中</span>
    bar = <span class="string">'bip'</span>
</code></pre>
<p># 在这个模块中定义的所有类都会通过 upper_attr(元类)创建。</p>
<pre><code class="python"><span class="class"><span class="keyword">class</span> <span class="title">UpperAttrMetaclass</span><span class="params">(type)</span>:</span>
    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, name, bases, dct)</span>:</span>
        attrs = ((name, value) <span class="keyword">for</span> name, value <span class="keyword">in</span> dct.items() 
                 <span class="keyword">if</span> <span class="keyword">not</span> name.startswith(<span class="string">'__'</span>))
        uppercase_attr = dict((name.upper(), value) <span class="keyword">for</span> name, value <span class="keyword">in</span> attrs)
        <span class="keyword">return</span> type.__new__(cls, name, bases, uppercase_attr)
</code></pre>
<p># 其他类只需要继承该类。因为该类的父类（type）定义了<code>__metaclass__</code>属性。</p>
<p>元类的本质很简单，难点在于使用到元类的问题都很复杂。主要是用途是创建API，如Django ORM。</p>
<blockquote>
<ol>
<li>拦截类的创建。</li>
<li>修改类。</li>
<li>返回修改后的类。</li>
</ol>
</blockquote>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://docs.python.org/zh-cn/3/tutorial/classes.html" target="_blank" rel="noopener">Python 文档</a></p>
<p><a href="https://python3-cookbook.readthedocs.io/zh_CN/latest/chapters/p08_classes_and_objects.html" target="_blank" rel="noopener">python3-cookbook</a></p>
<p><a href="http://blog.jobbole.com/21351/" target="_blank" rel="noopener">深刻理解Python中的元类(metaclass)</a></p>
<p><a href="https://stackoverflow.com/questions/100003/what-are-metaclasses-in-python" target="_blank" rel="noopener">What are metaclasses in Python?</a></p>
<p><a href="https://blog.csdn.net/qq_31780525/article/details/72639491" target="_blank" rel="noopener">Python中的类属性、实例属性与类方法、静态方法</a></p>
<p><a href="https://pyzh.readthedocs.io/en/latest/python-magic-methods-guide.html#id28" target="_blank" rel="noopener">Python魔法方法指南</a></p>
<p><a href="http://kaito-kidd.com/2017/02/22/python-magic-methods/" target="_blank" rel="noopener">Python技术进阶——魔法方法</a></p>
<p><a href="https://lotabout.me/2018/Understanding-Python-MetaClass/" target="_blank" rel="noopener">Python 元类 (MetaClass) 小教程</a></p>
<p><a href="https://mozillazg.com/2016/12/python-super-is-not-as-simple-as-you-thought.html" target="_blank" rel="noopener">Python: super 没那么简单</a></p>

      
    </div>

    

    
    
    

    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>csniu</li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://csniu.github.io/2019/12/13/Python中的类/" title>https://csniu.github.io/2019/12/13/Python中的类/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明出处！</li>
</ul>

      </div>
    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/12/13/Django-RESTful/" rel="next" title>
                <i class="fa fa-chevron-left"></i> 
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/12/13/Docker入门基础/" rel="prev" title>
                 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/my_avatar.jpg" alt="csniu">
            
              <p class="site-author-name" itemprop="name">csniu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">0</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">0</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/csniu" target="_blank" title="GitHub" rel="external nofollow"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:csniulv@aliyun.com" target="_blank" title="E-Mail" rel="external nofollow"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#date-2019-06-10-10-26-03"><span class="nav-number">1.</span> <span class="nav-text">date: 2019-06-10 10:26:03</span></a></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#定义类"><span class="nav-number"></span> <span class="nav-text">定义类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#代码分解"><span class="nav-number">1.</span> <span class="nav-text">代码分解</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#公有属性、私有属性、保护属性、特殊属性、类属性、实例属性"><span class="nav-number">2.</span> <span class="nav-text">公有属性、私有属性、保护属性、特殊属性、类属性、实例属性</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类方法、实例方法、静态方法、特殊方法"><span class="nav-number">3.</span> <span class="nav-text">类方法、实例方法、静态方法、特殊方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类的继承"><span class="nav-number">4.</span> <span class="nav-text">类的继承</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#多重继承"><span class="nav-number">4.1.</span> <span class="nav-text">多重继承</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#super-原理"><span class="nav-number">4.1.1.</span> <span class="nav-text">super 原理</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#类的魔法方法"><span class="nav-number"></span> <span class="nav-text">类的魔法方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#类的实例化"><span class="nav-number">1.</span> <span class="nav-text">类的实例化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其他魔法方法"><span class="nav-number">2.</span> <span class="nav-text">其他魔法方法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#元类"><span class="nav-number"></span> <span class="nav-text">元类</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#类的创建过程"><span class="nav-number">1.</span> <span class="nav-text">类的创建过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自定义元类"><span class="nav-number">2.</span> <span class="nav-text">自定义元类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#参考"><span class="nav-number"></span> <span class="nav-text">参考</span></a></li></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">csniu</span>

  

  
</div>


  



  <div class="powered-by">由 <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" rel="external nofollow" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.1.0</div>




        








        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  











  



  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/reading_progress/reading_progress.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.1.0"></script>



  

  
    <script id="dsq-count-scr" src="https://csniu.disqus.com/count.js" async></script>
  

  
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'https://csniu.github.io/2019/12/13/Python中的类/';
        this.page.identifier = '2019/12/13/Python中的类/';
        this.page.title = '';
      };
      function loadComments () {
        var d = document, s = d.createElement('script');
        s.src = 'https://csniu.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      }
      
        $(function () {
          var offsetTop = $('#comments').offset().top - $(window).height();
          if (offsetTop <= 0) {
            // load directly when there's no a scrollbar
            loadComments();
          } else {
            $(window).on('scroll.disqus_scroll', function () {
              var scrollTop = document.documentElement.scrollTop;
              if (scrollTop >= offsetTop) {
                $(window).off('.disqus_scroll');
                loadComments();
              }
            });
          }
        });
      
    </script>
  





	





  












  





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  

  

  

  

  
  
  
  <script src="/lib/bookmark/bookmark.min.js?v=1.0"></script>
  <script type="text/javascript">
  
    bookmark.scrollToMark('auto', "#more");
  
  </script>


</body>
</html>
